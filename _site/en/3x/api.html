<!DOCTYPE html>
<html lang="en">

  <head>
    <title>Express 3.x - API Reference</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/dropit.css">
    <link rel="stylesheet" href="/css/prism.css">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;amp;subset=latin,latin-ext">
    <link rel="stylesheet" href="/css/en.css">        
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script data-cfasync="false" src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script data-cfasync="false" src="/js/app.js"></script>
    <script data-cfasync="false" src="/js/retina.js"></script>
    <script data-cfasync="false" src="/js/dropit.js"></script>
    <script data-cfasync="false" src="/js/prism.js"></script>
</head>


  <body>

    <section class="content">

      <header>
  <div id="mobile-menu">
      <div id="nav-button" class="fa fa-bars fa-2x button"></div>
  </div>
  <section id="logo"><a href="/" class="express">Express</a>
  </section>
  <div id="navbar">
      <ul id="navmenu">
          <li><a href="/" id="home-menu">Home</a></li>
          <li>
              <ul id="getting-started-menu" class="menu">
                  <li><a href="/en/starter/installing.html">Getting started</a>
                      <ul>
                          <li>
                            <a href="/en/starter/installing.html">
                              Installing
                            </a>
                          </li>
                          <li>
                            <a href="/en/starter/hello-world.html">
                              Hello world
                            </a>
                          </li>
                          <li>
                          <a href="/en/starter/generator.html">
                            Express generator
                          </a>
                          </li>
                          <li>
                            <a href="/en/starter/basic-routing.html">
                              Basic routing
                            </a>
                          </li>
                          <li>
                            <a href="/en/starter/static-files.html">
                              Static files
                            </a>
                          </li>
                          <li>
                            <a href="/en/starter/faq.html">
                              FAQ
                            </a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
              <ul id="guide-menu" class="menu">
                  <li><a href="/en/guide/routing.html">Guide</a>
                      <ul>
                          <li><a href="/en/guide/routing.html">Routing</a>
                          </li>
                          <li><a href="/en/guide/writing-middleware.html">Writing middleware</a>
                          </li>
                          <li><a href="/en/guide/using-middleware.html">Using middleware</a>
                          </li>
                          <li><a href="/en/guide/using-template-engines.html">Using template engines</a>
                          </li>
                          <li><a href="/en/guide/error-handling.html">Error handling</a>
                          </li>
                          <li><a href="/en/guide/debugging.html">Debugging</a>
                          </li>
                          <li><a href="/en/guide/behind-proxies.html">Express behind proxies</a>
                          </li>
                          <li><a href="/en/guide/migrating-4.html">Moving to Express 4</a>
                          </li>
                          <li><a href="/en/guide/migrating-5.html">Moving to Express 5</a>
                          </li>
                          <li><a href="/en/guide/database-integration.html">Database integration</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
              <ul id="application-menu" class="menu">
                  <li><a href="/en/4x/api.html" class="active">API reference</a>
                      <ul>
                          <li><a href="/en/4x/api.html">4.x</a>
                          </li>
                          <li><a href="/en/3x/api.html">3.x (deprecated)</a>
                          </li>
                          <li><a href="/en/2x/">2.x (deprecated)</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
              <ul id="advanced-topics-menu" class="menu">
                  <li><a href="/en/advanced/developing-template-engines.html">Advanced topics</a>
                      <ul>
                          <li><a href="/en/advanced/developing-template-engines.html">Template engines</a>
                          </li>
                          <li><a href="/en/advanced/pm.html">Using process managers</a>
                          </li>
                          <li><a href="/en/advanced/security-updates.html">Security updates</a>
                          </li>
                          <li><a href="/en/advanced/best-practice-security.html">Security best practices</a>
                          </li>
                          <li><a href="/en/advanced/best-practice-performance.html">Performance best practices</a>
                          </li>

                      </ul>
                  </li>
              </ul>
          </li>
          <li>
              <ul id="resources-menu" class="menu">
                  <li><a href="/en/resources/glossary.html">Resources</a>
                      <ul>
                          <li><a href="/en/resources/glossary.html">Glossary</a>
                          </li>
                          <li><a href="/en/resources/middleware.html">Middleware</a>
                          </li>
                          <li><a href="/en/resources/community.html">Community</a>
                          </li>
                          <li><a href="/en/resources/books-blogs.html">Books and blogs</a>
                          </li>
                          <li><a href="/en/resources/applications.html">Applications</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
      </ul>
  </div><a href="http://strongloop.com/node-js/training/" title="Node and Express Training from StrongLoop" id="strongloop-header">Express and Node.js Training from StrongLoop</a>
</header>

    
      <ul id="menu">
    <li><a href="#express">express()</a></li>
    <li id="app-api"> <a href="#application">Application</a>
        <ul id="app-menu">
            <li><a href="#app.set">app.set()</a>
            </li>
            <li><a href="#app.get">app.get()</a>
            </li>
            <li><a href="#app.enable">app.enable()</a>
            </li>
            <li><a href="#app.disable">app.disable()</a>
            </li>
            <li><a href="#app.enabled">app.enabled()</a>
            </li>
            <li><a href="#app.disabled">app.disabled()</a>
            </li>
            <li><a href="#app.configure">app.configure()</a>
            </li>
            <li><a href="#app.use">app.use()</a>
            </li>
            <li><a href="#app-settings">application settings</a>
            </li>
            <li><a href="#app.engine">app.engine()</a>
            </li>
            <li><a href="#app.param">app.param()</a>
            </li>
            <li><a href="#app.VERB">application routing</a>
            </li>
            <li><a href="#app.all">app.all()</a>
            </li>
            <li><a href="#app.locals">app.locals</a>
            </li>
            <li><a href="#app.render">app.render()</a>
            </li>
            <li><a href="#app.routes">app.routes</a>
            </li>
            <li><a href="#app.listen">app.listen()</a>
            </li>
        </ul>
    </li>
    <li id="req-api"> <a href="#request">Request</a>
        <ul id="req-menu">
            <li><a href="#req.params">req.params</a>
            </li>
            <li><a href="#req.query">req.query</a>
            </li>
            <li><a href="#req.body">req.body</a>
            </li>
            <li><a href="#req.files">req.files</a>
            </li>
            <li><a href="#req.param">req.param()</a>
            </li>
            <li><a href="#req.route">req.route</a>
            </li>
            <li><a href="#req.cookies">req.cookies</a>
            </li>
            <li><a href="#req.signedCookies">req.signedCookies</a>
            </li>
            <li><a href="#req.get">req.get()</a>
            </li>
            <li><a href="#req.accepts">req.accepts()</a>
            </li>
            <li><a href="#req.accepted">req.accepted</a>
            </li>
            <li><a href="#req.is">req.is()</a>
            </li>
            <li><a href="#req.ip">req.ip</a>
            </li>
            <li><a href="#req.ips">req.ips</a>
            </li>
            <li><a href="#req.path">req.path</a>
            </li>
            <li><a href="#req.host">req.host</a>
            </li>
            <li><a href="#req.fresh">req.fresh</a>
            </li>
            <li><a href="#req.stale">req.stale</a>
            </li>
            <li><a href="#req.xhr">req.xhr</a>
            </li>
            <li><a href="#req.protocol">req.protocol</a>
            </li>
            <li><a href="#req.secure">req.secure</a>
            </li>
            <li><a href="#req.subdomains">req.subdomains</a>
            </li>
            <li><a href="#req.originalUrl">req.originalUrl</a>
            </li>
            <li><a href="#req.acceptedLanguages">req.acceptedLanguages</a>
            </li>
            <li><a href="#req.acceptedCharsets">req.acceptedCharsets</a>
            </li>
            <li><a href="#req.acceptsCharset">req.acceptsCharset()</a>
            </li>
            <li><a href="#req.acceptsLanguage">req.acceptsLanguage()</a>
            </li>
        </ul>
    </li>
    <li id="res-api"> <a href="#response">Response</a>
        <ul id="res-menu">
            <li><a href="#res.status">res.status()</a>
            </li>
            <li><a href="#res.set">res.set()</a>
            </li>
            <li><a href="#res.get">res.get()</a>
            </li>
            <li><a href="#res.cookie">res.cookie()</a>
            </li>
            <li><a href="#res.clearCookie">res.clearCookie()</a>
            </li>
            <li><a href="#res.redirect">res.redirect()</a>
            </li>
            <li><a href="#res.location">res.location()</a>
            </li>
            <li><a href="#res.charset">res.charset</a>
            </li>
            <li><a href="#res.send">res.send()</a>
            </li>
            <li><a href="#res.json">res.json()</a>
            </li>
            <li><a href="#res.jsonp">res.jsonp()</a>
            </li>
            <li><a href="#res.type">res.type()</a>
            </li>
            <li><a href="#res.format">res.format()</a>
            </li>
            <li><a href="#res.attachment">res.attachment()</a>
            </li>
            <li><a href="#res.sendfile">res.sendfile()</a>
            </li>
            <li><a href="#res.download">res.download()</a>
            </li>
            <li><a href="#res.links">res.links()</a>
            </li>
            <li><a href="#res.locals">res.locals</a>
            </li>
            <li><a href="#res.render">res.render()</a>
            </li>
        </ul>
    </li>
    <li id="middleware-api"><a href="#middleware">Middleware</a>
        <ul id="middleware-menu">
            <li><a href="#basicAuth">basicAuth()</a>
            </li>
            <li><a href="#bodyParser">bodyParser()</a>
            </li>
            <li><a href="#compress">compress()</a>
            </li>
            <li><a href="#cookieParser">cookieParser()</a>
            </li>
            <li><a href="#cookieSession">cookieSession()</a>
            </li>
            <li><a href="#csrf">csrf()</a>
            </li>
            <li><a href="#directory">directory()</a>
            </li>
        </ul>
    </li>
</ul>


      <div id="overlay"></div>

      

      <div id="api-doc">

  <div class="doc-box doc-warn">
    <p><strong>Express 3.x IS NO LONGER MAINTAINED</strong></p>

    <p>Known and unknown security and performance issues in 3.x have not been addressed since the last update (1 August, 2015). It is highly recommended to use the latest version of Express.</p>
  </div>

  <h1>3.x API</h1>

  <p><a id="express" class="h2"></a></p>
  <h2>express()</h2>

  <p>Creates an Express application. The <code class="highlighter-rouge">express()</code> function is a top-level function exported by the <em>express</em> module.</p>

  <div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'hello world'</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
</code></pre>
  </div>

  <p><a id="application" class="h2"></a></p>
  <h2>Application</h2>

  <section>
    <h3 id="app.set">app.set(name, value)</h3>

    <p>Assigns setting <code class="highlighter-rouge">name</code> to <code class="highlighter-rouge">value</code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'My Site'</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'title'</span><span class="p">);</span>
<span class="c1">// =&gt; "My Site"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.get">app.get(name)</h3>

    <p>Get setting <code class="highlighter-rouge">name</code> value.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'title'</span><span class="p">);</span>
<span class="c1">// =&gt; undefined</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'My Site'</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'title'</span><span class="p">);</span>
<span class="c1">// =&gt; "My Site"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.enable">app.enable(name)</h3>

    <p>Set setting <code class="highlighter-rouge">name</code> to <code class="highlighter-rouge">true</code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="s1">'trust proxy'</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'trust proxy'</span><span class="p">);</span>
<span class="c1">// =&gt; true</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.disable">app.disable(name)</h3>

    <p>Set setting <code class="highlighter-rouge">name</code> to <code class="highlighter-rouge">false</code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">disable</span><span class="p">(</span><span class="s1">'trust proxy'</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'trust proxy'</span><span class="p">);</span>
<span class="c1">// =&gt; false</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.enabled">app.enabled(name)</h3>

    <p>Check if setting <code class="highlighter-rouge">name</code> is enabled.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">enabled</span><span class="p">(</span><span class="s1">'trust proxy'</span><span class="p">);</span>
<span class="c1">// =&gt; false</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="s1">'trust proxy'</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">enabled</span><span class="p">(</span><span class="s1">'trust proxy'</span><span class="p">);</span>
<span class="c1">// =&gt; true</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.disabled">app.disabled(name)</h3>

    <p>Check if setting <code class="highlighter-rouge">name</code> is disabled.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">disabled</span><span class="p">(</span><span class="s1">'trust proxy'</span><span class="p">);</span>
<span class="c1">// =&gt; true</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="s1">'trust proxy'</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">disabled</span><span class="p">(</span><span class="s1">'trust proxy'</span><span class="p">);</span>
<span class="c1">// =&gt; false</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.configure">app.configure([env], callback)</h3>

    <p>Conditionally invoke <code class="highlighter-rouge">callback</code> when <code class="highlighter-rouge">env</code> matches <code class="highlighter-rouge">app.get('env')</code>,
aka <code class="highlighter-rouge">process.env.NODE_ENV</code>. This method remains for legacy reasons, and is effectively
an <code class="highlighter-rouge">if</code> statement as illustrated in the following snippets. These functions are <em>not</em>
required in order to use <code class="highlighter-rouge">app.set()</code> and other configuration methods.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// all environments</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">configure</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'My Application'</span><span class="p">);</span>
<span class="p">})</span>

<span class="c1">// development only</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">configure</span><span class="p">(</span><span class="s1">'development'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'db uri'</span><span class="p">,</span> <span class="s1">'localhost/dev'</span><span class="p">);</span>
<span class="p">})</span>

<span class="c1">// production only</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">configure</span><span class="p">(</span><span class="s1">'production'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'db uri'</span><span class="p">,</span> <span class="s1">'n.n.n.n/prod'</span><span class="p">);</span>
<span class="p">})</span>
</code></pre>
    </div>

    <p>Is effectively sugar for:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// all environments</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'My Application'</span><span class="p">);</span>

<span class="c1">// development only</span>
<span class="k">if</span> <span class="p">(</span><span class="s1">'development'</span> <span class="o">==</span> <span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'env'</span><span class="p">))</span> <span class="p">{</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'db uri'</span><span class="p">,</span> <span class="s1">'localhost/dev'</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// production only</span>
<span class="k">if</span> <span class="p">(</span><span class="s1">'production'</span> <span class="o">==</span> <span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'env'</span><span class="p">))</span> <span class="p">{</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'db uri'</span><span class="p">,</span> <span class="s1">'n.n.n.n/prod'</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.use">app.use([path], function)</h3>

    <p>Use the given middleware <code class="highlighter-rouge">function</code>, with optional mount <code class="highlighter-rouge">path</code>,
defaulting to “/”.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

<span class="c1">// simple logger</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'%s %s'</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">method</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">url</span><span class="p">);</span>
  <span class="nx">next</span><span class="p">();</span>
<span class="p">});</span>

<span class="c1">// respond</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">){</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'Hello World'</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
</code></pre>
    </div>

    <p>The “mount” path is stripped and is <strong>not</strong> visible
to the middleware <code class="highlighter-rouge">function</code>. The main effect of this feature is that
mounted middleware may operate without code changes regardless of its “prefix”
pathname.</p>

    <div class="doc-box doc-notice">
      <p>A route will match any path that follows its path immediately with either a “<code class="highlighter-rouge">/</code>” or a “<code class="highlighter-rouge">.</code>”. For example: <code class="highlighter-rouge">app.use('/apple', ...)</code> will match <em>/apple</em>, <em>/apple/images</em>, <em>/apple/images/news</em>, <em>/apple.html</em>, <em>/apple.html.txt</em>, and so on.</p>
    </div>

    <p>Here’s a concrete example, take the typical use-case of serving files in ./public
using the <code class="highlighter-rouge">express.static()</code> middleware:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// GET /javascripts/jquery.js</span>
<span class="c1">// GET /style.css</span>
<span class="c1">// GET /favicon.ico</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">'/public'</span><span class="p">));</span>
</code></pre>
    </div>

    <p>Say for example you wanted to prefix all static files with “/static”, you could
use the “mounting” feature to support this. Mounted middleware functions are <em>not</em>
invoked unless the <code class="highlighter-rouge">req.url</code> contains this prefix, at which point
it is stripped when the function is invoked. This affects this function only,
subsequent middleware will see <code class="highlighter-rouge">req.url</code> with “/static” included
unless they are mounted as well.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// GET /static/javascripts/jquery.js</span>
<span class="c1">// GET /static/style.css</span>
<span class="c1">// GET /static/favicon.ico</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'/static'</span><span class="p">,</span> <span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">'/public'</span><span class="p">));</span>
</code></pre>
    </div>

    <p>The order of which middleware are “defined” using <code class="highlighter-rouge">app.use()</code> is
very important, they are invoked sequentially, thus this defines middleware
precedence. For example usually <code class="highlighter-rouge">express.logger()</code> is the very
first middleware you would use, logging every request:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">logger</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">'/public'</span><span class="p">));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'Hello'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
    </div>

    <p>Now suppose you wanted to ignore logging requests for static files, but to
continue logging routes and middleware defined after <code class="highlighter-rouge">logger()</code>,
you would simply move <code class="highlighter-rouge">static()</code> above:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">'/public'</span><span class="p">));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">logger</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'Hello'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
    </div>

    <p>Another concrete example would be serving files from multiple directories,
giving precedence to “./public” over the others:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">'/public'</span><span class="p">));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">'/files'</span><span class="p">));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">'/uploads'</span><span class="p">));</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app-settings">settings</h3>

    <p>The following settings are provided to alter how Express will behave:</p>

    <ul>
      <li><code class="highlighter-rouge">env</code> Environment mode, defaults to process.env.NODE_ENV or “development”</li>
      <li><code class="highlighter-rouge">trust proxy</code> Enables reverse proxy support, disabled by default</li>
      <li><code class="highlighter-rouge">jsonp callback name</code> Changes the default callback name of ?callback=</li>
      <li><code class="highlighter-rouge">json replacer</code> JSON replacer callback, null by default</li>
      <li><code class="highlighter-rouge">json spaces</code> JSON response spaces for formatting, defaults to 2 in development, 0 in production</li>
      <li><code class="highlighter-rouge">case sensitive routing</code> Enable case sensitivity, disabled by default, treating “/Foo” and “/foo” as the same</li>
      <li><code class="highlighter-rouge">strict routing</code> Enable strict routing, by default “/foo” and “/foo/” are treated the same by the router</li>
      <li><code class="highlighter-rouge">view cache</code> Enables view template compilation caching, enabled in production by default</li>
      <li><code class="highlighter-rouge">view engine</code> The default engine extension to use when omitted</li>
      <li><code class="highlighter-rouge">views</code> The view directory path, defaulting to “process.cwd() + ‘/views’”</li>
    </ul>

  </section>

  <section>
    <h3 id="app.engine">app.engine(ext, callback)</h3>

    <p>Register the given template engine <code class="highlighter-rouge">callback</code> as <code class="highlighter-rouge">ext</code></p>

    <p>By default will <code class="highlighter-rouge">require()</code> the engine based on the
file extension. For example if you try to render
a “foo.jade” file Express will invoke the following internally,
and cache the <code class="highlighter-rouge">require()</code> on subsequent calls to increase
performance.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">engine</span><span class="p">(</span><span class="s1">'jade'</span><span class="p">,</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'jade'</span><span class="p">).</span><span class="nx">__express</span><span class="p">);</span>
</code></pre>
    </div>

    <p>For engines that do not provide <code class="highlighter-rouge">.__express</code> out of the box -
or if you wish to “map” a different extension to the template engine
you may use this method. For example mapping the EJS template engine to
“.html” files:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">engine</span><span class="p">(</span><span class="s1">'html'</span><span class="p">,</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'ejs'</span><span class="p">).</span><span class="nx">renderFile</span><span class="p">);</span>
</code></pre>
    </div>

    <p>In this case EJS provides a <code class="highlighter-rouge">.renderFile()</code> method with
the same signature that Express expects: <code class="highlighter-rouge">(path, options, callback)</code>,
though note that it aliases this method as <code class="highlighter-rouge">ejs.__express</code> internally
so if you’re using “.ejs” extensions you dont need to do anything.</p>

    <p>Some template engines do not follow this convention, the
<a href="https://github.com/visionmedia/consolidate.js">consolidate.js</a>
library was created to map all of node’s popular template
engines to follow this convention, thus allowing them to
work seemlessly within Express.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">engines</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'consolidate'</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">engine</span><span class="p">(</span><span class="s1">'haml'</span><span class="p">,</span> <span class="nx">engines</span><span class="p">.</span><span class="nx">haml</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">engine</span><span class="p">(</span><span class="s1">'html'</span><span class="p">,</span> <span class="nx">engines</span><span class="p">.</span><span class="nx">hogan</span><span class="p">);</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.param">app.param([name], callback)</h3>

    <p>Map logic to route parameters. For example when <code class="highlighter-rouge">:user</code>
is present in a route path you may map user loading logic to automatically
provide <code class="highlighter-rouge">req.user</code> to the route, or perform validations
on the parameter input.</p>

    <p>The following snippet illustrates how the <code class="highlighter-rouge">callback</code>
is much like middleware, thus supporting async operations, however
providing the additional value of the parameter, here named as <code class="highlighter-rouge">id</code>.
An attempt to load the user is then performed, assigning <code class="highlighter-rouge">req.user</code>,
otherwise passing an error to <code class="highlighter-rouge">next(err)</code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">,</span> <span class="nx">id</span><span class="p">){</span>
  <span class="nx">User</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">user</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">next</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">req</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">user</span><span class="p">;</span>
      <span class="nx">next</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">next</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">'failed to load user'</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>
    </div>

    <p>Alternatively you may pass only a <code class="highlighter-rouge">callback</code>, in which
case you have the opportunity to alter the <code class="highlighter-rouge">app.param()</code> API.
For example the <a href="http://github.com/expressjs/express-params">express-params</a>
defines the following callback which allows you to restrict parameters to a given
regular expression.</p>

    <p>This example is a bit more advanced, checking if the second argument is a regular
expression, returning the callback which acts much like the “user” param example.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">fn</span><span class="p">){</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">fn</span> <span class="k">instanceof</span> <span class="nb">RegExp</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">,</span> <span class="nx">val</span><span class="p">){</span>
      <span class="kd">var</span> <span class="nx">captures</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">captures</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">val</span><span class="p">)))</span> <span class="p">{</span>
        <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">captures</span><span class="p">;</span>
        <span class="nx">next</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">next</span><span class="p">(</span><span class="s1">'route'</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
    </div>

    <p>The method could now be used to effectively validate parameters, or also
parse them to provide capture groups:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span> <span class="sr">/^</span><span class="se">\d</span><span class="sr">+$/</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/user/:id'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'user '</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="s1">'range'</span><span class="p">,</span> <span class="sr">/^</span><span class="se">(\w</span><span class="sr">+</span><span class="se">)\.\.(\w</span><span class="sr">+</span><span class="se">)?</span><span class="sr">$/</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/range/:range'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">range</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">range</span><span class="p">;</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'from '</span> <span class="o">+</span> <span class="nx">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' to '</span> <span class="o">+</span> <span class="nx">range</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
<span class="p">});</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.VERB">app.VERB(path, [callback...], callback)</h3>

    <p>The <code class="highlighter-rouge">app.VERB()</code> methods provide the routing functionality
in Express, where <strong>VERB</strong> is one of the HTTP verbs, such
as <code class="highlighter-rouge">app.post()</code>. Multiple callbacks may be given, all are treated
equally, and behave just like middleware, with the one exception that
these callbacks may invoke <code class="highlighter-rouge">next('route')</code> to bypass the
remaining route callback(s). This mechanism can be used to perform pre-conditions
on a route then pass control to subsequent routes when there is no reason to proceed
with the route matched.</p>

    <p>The following snippet illustrates the most simple route definition possible. Express
translates the path strings to regular expressions, used internally to match incoming requests.
Query strings are <em>not</em> considered when peforming these matches, for example “GET /”
would match the following route, as would “GET /?name=tobi”.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'hello world'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
    </div>

    <p>Regular expressions may also be used, and can be useful
if you have very specific restraints, for example the following
would match “GET /commits/71dbb9c” as well as “GET /commits/71dbb9c..4c084f9”.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="sr">/^</span><span class="se">\/</span><span class="sr">commits</span><span class="se">\/(\w</span><span class="sr">+</span><span class="se">)(?:\.\.(\w</span><span class="sr">+</span><span class="se">))?</span><span class="sr">$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">from</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="kd">var</span> <span class="nx">to</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="s1">'HEAD'</span><span class="p">;</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'commit range '</span> <span class="o">+</span> <span class="nx">from</span> <span class="o">+</span> <span class="s1">'..'</span> <span class="o">+</span> <span class="nx">to</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
    </div>

    <p>Several callbacks may also be passed, useful for re-using middleware
that load resources, perform validations, etc.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/user/:id'</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">load</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="c1">// ... </span>
<span class="p">})</span>
</code></pre>
    </div>

    <p>These callbacks may be passed within arrays as well, these arrays are
simply flattened when passed:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">middleware</span> <span class="o">=</span> <span class="p">[</span><span class="nx">loadForum</span><span class="p">,</span> <span class="nx">loadThread</span><span class="p">];</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/forum/:fid/thread/:tid'</span><span class="p">,</span> <span class="nx">middleware</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="c1">// ...</span>
<span class="p">})</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/forum/:fid/thread/:tid'</span><span class="p">,</span> <span class="nx">middleware</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="c1">// ...</span>
<span class="p">})</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.all">app.all(path, [callback...], callback)</h3>

    <p>This method functions just like the <code class="highlighter-rouge">app.VERB()</code> methods,
however it matches all HTTP verbs.</p>

    <p>This method is extremely useful for
mapping “global” logic for specific path prefixes or arbitrary matches.
For example if you placed the following route at the top of all other
route definitions, it would require that all routes from that point on
would require authentication, and automatically load a user. Keep in mind
that these callbacks do not have to act as end points, <code class="highlighter-rouge">loadUser</code>
can perform a task, then <code class="highlighter-rouge">next()</code> to continue matching subsequent
routes.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>  <span class="nx">app</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="s1">'*'</span><span class="p">,</span> <span class="nx">requireAuthentication</span><span class="p">,</span> <span class="nx">loadUser</span><span class="p">);</span>
</code></pre>
    </div>

    <p>Or the equivalent:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>  <span class="nx">app</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="s1">'*'</span><span class="p">,</span> <span class="nx">requireAuthentication</span><span class="p">)</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="s1">'*'</span><span class="p">,</span> <span class="nx">loadUser</span><span class="p">);</span>
</code></pre>
    </div>

    <p>Another great example of this is white-listed “global” functionality. Here
the example is much like before, however only restricting paths prefixed with
“/api”:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>  <span class="nx">app</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="s1">'/api/*'</span><span class="p">,</span> <span class="nx">requireAuthentication</span><span class="p">);</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.locals">app.locals</h3>

    <p>Application local variables are provided to all templates
rendered within the application. This is useful for providing
helper functions to templates, as well as app-level data.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="s1">'My App'</span><span class="p">;</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">strftime</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'strftime'</span><span class="p">);</span>
</code></pre>
    </div>

    <p>The <code class="highlighter-rouge">app.locals</code> object is a JavaScript <code class="highlighter-rouge">Function</code>,
which when invoked with an object will merge properties into itself, providing
a simple way to expose existing objects as local variables.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">locals</span><span class="p">({</span>
  <span class="na">title</span><span class="p">:</span> <span class="s1">'My App'</span><span class="p">,</span>
  <span class="na">phone</span><span class="p">:</span> <span class="s1">'1-250-858-9990'</span><span class="p">,</span>
  <span class="na">email</span><span class="p">:</span> <span class="s1">'me@myapp.com'</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">title</span>
<span class="c1">// =&gt; 'My App'</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">email</span>
<span class="c1">// =&gt; 'me@myapp.com'</span>
</code></pre>
    </div>

    <p>A consequence of the <code class="highlighter-rouge">app.locals</code> Object being ultimately a Javascript Function Object is that you must not reuse existing (native) named properties for your own variable names, such as <code class="highlighter-rouge">name, apply, bind, call, arguments, length, constructor</code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">locals</span><span class="p">({</span><span class="na">name</span><span class="p">:</span> <span class="s1">'My App'</span><span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">name</span>
<span class="c1">// =&gt; return 'app.locals' in place of 'My App' (app.locals is a Function !)</span>
<span class="c1">// =&gt; if name's variable is used in a template, a ReferenceError will be returned.</span>
</code></pre>
    </div>

    <p>The full list of native named properties can be found in many specifications. The <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference">JavaScript specification</a> introduced original properties, some of which still recognized by modern engines, and the <a href="http://www.ecma-international.org/ecma-262/5.1/">EcmaScript specification</a> then built on it and normalized the set of properties, adding new ones and removing deprecated ones. Check out properties for Functions and Objects if interested.</p>

    <p>By default Express exposes only a single app-level local variable, <code class="highlighter-rouge">settings</code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'My App'</span><span class="p">);</span>
<span class="c1">// use settings.title in a view</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.render">app.render(view, [options], callback)</h3>

    <p>Render a <code class="highlighter-rouge">view</code> with a callback responding with
the rendered string. This is the app-level variant of <code class="highlighter-rouge">res.render()</code>,
and otherwise behaves the same way.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'email'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">html</span><span class="p">){</span>
  <span class="c1">// ...</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'email'</span><span class="p">,</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'Tobi'</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">html</span><span class="p">){</span>
  <span class="c1">// ...</span>
<span class="p">});</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.routes">app.routes</h3>

    <p>The <code class="highlighter-rouge">app.routes</code> object houses all of the routes defined mapped
by the associated HTTP verb. This object may be used for introspection capabilities,
for example Express uses this internally not only for routing but to provide default</p>
    <string>OPTIONS</string>
    <p>behaviour unless <code class="highlighter-rouge">app.options()</code> is used. Your application
or framework may also remove routes by simply by removing them from this object.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">routes</span><span class="p">)</span>

<span class="p">{</span> <span class="nl">get</span><span class="p">:</span> 
   <span class="p">[</span> <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'/'</span><span class="p">,</span>
       <span class="na">method</span><span class="p">:</span> <span class="s1">'get'</span><span class="p">,</span>
       <span class="na">callbacks</span><span class="p">:</span> <span class="p">[</span><span class="nb">Object</span><span class="p">],</span>
       <span class="na">keys</span><span class="p">:</span> <span class="p">[],</span>
       <span class="na">regexp</span><span class="p">:</span> <span class="sr">/^</span><span class="se">\/\/?</span><span class="sr">$/i</span> <span class="p">},</span>
     <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'/user/:id'</span><span class="p">,</span>
       <span class="na">method</span><span class="p">:</span> <span class="s1">'get'</span><span class="p">,</span>
       <span class="na">callbacks</span><span class="p">:</span> <span class="p">[</span><span class="nb">Object</span><span class="p">],</span>
       <span class="na">keys</span><span class="p">:</span> <span class="p">[{</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'id'</span><span class="p">,</span> <span class="na">optional</span><span class="p">:</span> <span class="kc">false</span> <span class="p">}],</span>
       <span class="na">regexp</span><span class="p">:</span> <span class="sr">/^</span><span class="se">\/</span><span class="sr">user</span><span class="se">\/(?:([^\/]</span><span class="sr">+</span><span class="se">?))\/?</span><span class="sr">$/i</span> <span class="p">}</span> <span class="p">],</span>
  <span class="k">delete</span><span class="err">:</span> 
   <span class="p">[</span> <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'/user/:id'</span><span class="p">,</span>
       <span class="na">method</span><span class="p">:</span> <span class="s1">'delete'</span><span class="p">,</span>
       <span class="na">callbacks</span><span class="p">:</span> <span class="p">[</span><span class="nb">Object</span><span class="p">],</span>
       <span class="na">keys</span><span class="p">:</span> <span class="p">[</span><span class="nb">Object</span><span class="p">],</span>
       <span class="na">regexp</span><span class="p">:</span> <span class="sr">/^</span><span class="se">\/</span><span class="sr">user</span><span class="se">\/(?:([^\/]</span><span class="sr">+</span><span class="se">?))\/?</span><span class="sr">$/i</span> <span class="p">}</span> <span class="p">]</span> <span class="p">}</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="app.listen">app.listen()</h3>

    <p>Bind and listen for connections on the given host and port,
this method is identical to node’s <a href="http://nodejs.org/api/http.html#http_server_listen_port_hostname_backlog_callback">http.Server#listen()</a>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
</code></pre>
    </div>

    <p>The <code class="highlighter-rouge">app</code> returned by <code class="highlighter-rouge">express()</code> is in fact a JavaScript
<code class="highlighter-rouge">Function</code>, designed to be passed to node’s http servers as a callback
to handle requests. This allows you to provide both HTTP and HTTPS versions of
your app with the same codebase easily, as the app does not inherit from these,
it is simply a callback:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">https</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'https'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'http'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

<span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="nx">app</span><span class="p">).</span><span class="nx">listen</span><span class="p">(</span><span class="mi">80</span><span class="p">);</span>
<span class="nx">https</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="nx">app</span><span class="p">).</span><span class="nx">listen</span><span class="p">(</span><span class="mi">443</span><span class="p">);</span>
</code></pre>
    </div>

    <p>The <code class="highlighter-rouge">app.listen()</code> method is simply a convenience method defined as,
if you wish to use HTTPS or provide both, use the technique above.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">listen</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">server</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
    </div>

  </section>

  <p><a id="request" class="h2"></a></p>
  <h2>Request</h2>

  <section>
    <h3 id="req.params">req.params</h3>

    <p>This property is an array containing properties mapped to the named route “parameters”.
For example if you have the route <code class="highlighter-rouge">/user/:name</code>, then the “name” property
is available to you as <code class="highlighter-rouge">req.params.name</code>. This object defaults to <code class="highlighter-rouge"><span class="p">{}</span></code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// GET /user/tj</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">name</span>
<span class="c1">// =&gt; "tj"</span>
</code></pre>
    </div>

    <p>When a regular expression is used for the route definition, capture groups
are provided in the array using <code class="highlighter-rouge">req.params[N]</code>, where <code class="highlighter-rouge">N</code>
is the nth capture group. This rule is applied to unnamed wild-card matches
with string routes such as <code class="highlighter-rouge">/file/*</code>:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// GET /file/javascripts/jquery.js</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1">// =&gt; "javascripts/jquery.js"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.query">req.query</h3>

    <p>This property is an object containing the parsed query-string,
defaulting to <code class="highlighter-rouge"><span class="p">{}</span></code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// GET /search?q=tobi+ferret</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">q</span>
<span class="c1">// =&gt; "tobi ferret"</span>

<span class="c1">// GET /shoes?order=desc&amp;shoe[color]=blue&amp;shoe[type]=converse</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">order</span>
<span class="c1">// =&gt; "desc"</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">shoe</span><span class="p">.</span><span class="nx">color</span>
<span class="c1">// =&gt; "blue"</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">shoe</span><span class="p">.</span><span class="nx">type</span>
<span class="c1">// =&gt; "converse"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.body">req.body</h3>

    <p>This property is an object containing the parsed request body. This feature
is provided by the <code class="highlighter-rouge">bodyParser()</code> middleware, though other body
parsing middleware may follow this convention as well. This property
defaults to <code class="highlighter-rouge"><span class="p">{}</span></code> when <code class="highlighter-rouge">bodyParser()</code> is used.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// POST user[name]=tobi&amp;user[email]=tobi@learnboost.com</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span>
<span class="c1">// =&gt; "tobi"</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">email</span>
<span class="c1">// =&gt; "tobi@learnboost.com"</span>

<span class="c1">// POST { "name": "tobi" }</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">name</span>
<span class="c1">// =&gt; "tobi"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.files">req.files</h3>

    <p>This property is an object of the files uploaded. This feature
is provided by the <code class="highlighter-rouge">bodyParser()</code> middleware, though other body
parsing middleware may follow this convention as well. This property
defaults to <code class="highlighter-rouge"><span class="p">{}</span></code> when <code class="highlighter-rouge">bodyParser()</code> is used.</p>

    <p>For example if a <strong>file</strong> field was named “image”,
and a file was uploaded, <code class="highlighter-rouge">req.files.image</code> would contain
the following <code class="highlighter-rouge">File</code> object:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span> <span class="nl">size</span><span class="p">:</span> <span class="mi">74643</span><span class="p">,</span>
  <span class="nx">path</span><span class="err">:</span> <span class="s1">'/tmp/8ef9c52abe857867fd0a4e9a819d1876'</span><span class="p">,</span>
  <span class="nx">name</span><span class="err">:</span> <span class="s1">'edge.png'</span><span class="p">,</span>
  <span class="nx">type</span><span class="err">:</span> <span class="s1">'image/png'</span><span class="p">,</span>
  <span class="nx">hash</span><span class="err">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nx">lastModifiedDate</span><span class="err">:</span> <span class="nx">Thu</span> <span class="nx">Aug</span> <span class="mi">09</span> <span class="mi">2012</span> <span class="mi">20</span><span class="err">:</span><span class="mi">07</span><span class="err">:</span><span class="mi">51</span> <span class="nx">GMT</span><span class="o">-</span><span class="mi">0700</span> <span class="p">(</span><span class="nx">PDT</span><span class="p">),</span>
  <span class="nx">_writeStream</span><span class="err">:</span> 
   <span class="p">{</span> <span class="nl">path</span><span class="p">:</span> <span class="s1">'/tmp/8ef9c52abe857867fd0a4e9a819d1876'</span><span class="p">,</span>
     <span class="nx">fd</span><span class="err">:</span> <span class="mi">13</span><span class="p">,</span>
     <span class="nx">writable</span><span class="err">:</span> <span class="kc">false</span><span class="p">,</span>
     <span class="nx">flags</span><span class="err">:</span> <span class="s1">'w'</span><span class="p">,</span>
     <span class="nx">encoding</span><span class="err">:</span> <span class="s1">'binary'</span><span class="p">,</span>
     <span class="nx">mode</span><span class="err">:</span> <span class="mi">438</span><span class="p">,</span>
     <span class="nx">bytesWritten</span><span class="err">:</span> <span class="mi">74643</span><span class="p">,</span>
     <span class="nx">busy</span><span class="err">:</span> <span class="kc">false</span><span class="p">,</span>
     <span class="nx">_queue</span><span class="err">:</span> <span class="p">[],</span>
     <span class="nx">_open</span><span class="err">:</span> <span class="p">[</span><span class="nb">Function</span><span class="p">],</span>
     <span class="nx">drainable</span><span class="err">:</span> <span class="kc">true</span> <span class="p">},</span>
  <span class="nx">length</span><span class="err">:</span> <span class="p">[</span><span class="nx">Getter</span><span class="p">],</span>
  <span class="nx">filename</span><span class="err">:</span> <span class="p">[</span><span class="nx">Getter</span><span class="p">],</span>
  <span class="nx">mime</span><span class="err">:</span> <span class="p">[</span><span class="nx">Getter</span><span class="p">]</span> <span class="p">}</span>
</code></pre>
    </div>

    <p>The <code class="highlighter-rouge">bodyParser()</code> middleware utilizes the
<a href="https://github.com/felixge/node-formidable">node-formidable</a>
module internally, and accepts the same options. An example of this
is the <code class="highlighter-rouge">keepExtensions</code> formidable option, defaulting to <strong>false</strong>
which in this case gives you the filename “/tmp/8ef9c52abe857867fd0a4e9a819d1876” void of
the “.png” extension. To enable this, and others you may pass them to <code class="highlighter-rouge">bodyParser()</code>:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">bodyParser</span><span class="p">({</span> <span class="na">keepExtensions</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">uploadDir</span><span class="p">:</span> <span class="s1">'/my/files'</span> <span class="p">}));</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.param">req.param(name)</h3>

    <p>Return the value of param <code class="highlighter-rouge">name</code> when present.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// ?name=tobi</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span>
<span class="c1">// =&gt; "tobi"</span>

<span class="c1">// POST name=tobi</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span>
<span class="c1">// =&gt; "tobi"</span>

<span class="c1">// /user/tobi for /user/:name </span>
<span class="nx">req</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span>
<span class="c1">// =&gt; "tobi"</span>
</code></pre>
    </div>

    <p>Lookup is performed in the following order:</p>

    <ul>
      <li><code class="highlighter-rouge">req.params</code></li>
      <li><code class="highlighter-rouge">req.body</code></li>
      <li><code class="highlighter-rouge">req.query</code></li>
    </ul>

    <p>Direct access to <code class="highlighter-rouge">req.body</code>, <code class="highlighter-rouge">req.params</code>,
and <code class="highlighter-rouge">req.query</code> should be favoured for clarity - unless
you truly accept input from each object.</p>

  </section>

  <section>
    <h3 id="req.route">req.route</h3>

    <p>The currently matched <code class="highlighter-rouge">Route</code> containing
several properties such as the route’s original path
string, the regexp generated, and so on.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/user/:id?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">route</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
    </div>

    <p>Example output from the previous snippet:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span> <span class="nl">path</span><span class="p">:</span> <span class="s1">'/user/:id?'</span><span class="p">,</span>
  <span class="nx">method</span><span class="err">:</span> <span class="s1">'get'</span><span class="p">,</span>
  <span class="nx">callbacks</span><span class="err">:</span> <span class="p">[</span> <span class="p">[</span><span class="nb">Function</span><span class="p">]</span> <span class="p">],</span>
  <span class="nx">keys</span><span class="err">:</span> <span class="p">[</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'id'</span><span class="p">,</span> <span class="na">optional</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}</span> <span class="p">],</span>
  <span class="nx">regexp</span><span class="err">:</span> <span class="o">/^</span><span class="err">\</span><span class="o">/</span><span class="nx">user</span><span class="p">(?:</span><span class="err">\</span><span class="o">/</span><span class="p">([</span><span class="o">^</span><span class="err">\</span><span class="o">/</span><span class="p">]</span><span class="o">+</span><span class="p">?))?</span><span class="err">\</span><span class="o">/</span><span class="p">?</span><span class="nx">$</span><span class="o">/</span><span class="nx">i</span><span class="p">,</span>
  <span class="nx">params</span><span class="p">:</span> <span class="p">[</span> <span class="nx">id</span><span class="p">:</span> <span class="s1">'12'</span> <span class="p">]</span> <span class="p">}</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.cookies">req.cookies</h3>

    <p>This object requires the <code class="highlighter-rouge">cookieParser()</code> middleware for use.
It contains cookies sent by the user-agent. If no cookies are sent, it 
defaults to <code class="highlighter-rouge"><span class="p">{}</span></code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Cookie: name=tj</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">name</span>
<span class="c1">// =&gt; "tj"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.signedCookies">req.signedCookies</h3>

    <p>This object requires the <code class="highlighter-rouge">cookieParser(secret)</code> middleware for use. 
It contains signed cookies sent by the user-agent, unsigned and ready for use. 
Signed cookies reside in a different object to show developer intent; otherwise, 
a malicious attack could be placed on <code class="highlighter-rouge">req.cookie</code> values (which are easy to spoof). 
Note that signing a cookie does not make it “hidden” or encrypted; this simply 
prevents tampering (because the secret used to sign is private). If no signed 
cookies are sent, it defaults to <code class="highlighter-rouge"><span class="p">{}</span></code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Cookie: user=tobi.CP7AWaXDfAKIRfH49dQzKJx7sKzzSoPq7/AcBBRVwlI3</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">signedCookies</span><span class="p">.</span><span class="nx">user</span>
<span class="c1">// =&gt; "tobi"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.get">req.get(field)</h3>

    <p>Get the case-insensitive request header <code class="highlighter-rouge">field</code>. The “Referrer” and “Referer” fields are interchangeable.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">req</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">);</span>
<span class="c1">// =&gt; "text/plain"</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'content-type'</span><span class="p">);</span>
<span class="c1">// =&gt; "text/plain"</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'Something'</span><span class="p">);</span>
<span class="c1">// =&gt; undefined</span>
</code></pre>
    </div>

    <p>p Aliased as <code class="highlighter-rouge">req.header(field)</code>.</p>

  </section>

  <section>
    <h3 id="req.accepts">req.accepts(types)</h3>

    <p>Check if the given <code class="highlighter-rouge">types</code> are acceptable, returning
the best match when true, otherwise <code class="highlighter-rouge">undefined</code> - in which
case you should respond with 406 “Not Acceptable”.</p>

    <p>The <code class="highlighter-rouge">type</code> value may be a single mime type string
such as “application/json”, the extension name
such as “json”, a comma-delimited list or an array. When a list
or array is given the best match, if any is returned.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Accept: text/html</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">accepts</span><span class="p">(</span><span class="s1">'html'</span><span class="p">);</span>
<span class="c1">// =&gt; "html"</span>

<span class="c1">// Accept: text/*, application/json</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">accepts</span><span class="p">(</span><span class="s1">'html'</span><span class="p">);</span>
<span class="c1">// =&gt; "html"</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">accepts</span><span class="p">(</span><span class="s1">'text/html'</span><span class="p">);</span>
<span class="c1">// =&gt; "text/html"</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">accepts</span><span class="p">(</span><span class="s1">'json, text'</span><span class="p">);</span>
<span class="c1">// =&gt; "json"</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">accepts</span><span class="p">(</span><span class="s1">'application/json'</span><span class="p">);</span>
<span class="c1">// =&gt; "application/json"</span>

<span class="c1">// Accept: text/*, application/json</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">accepts</span><span class="p">(</span><span class="s1">'image/png'</span><span class="p">);</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">accepts</span><span class="p">(</span><span class="s1">'png'</span><span class="p">);</span>
<span class="c1">// =&gt; undefined</span>

<span class="c1">// Accept: text/*;q=.5, application/json</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">accepts</span><span class="p">([</span><span class="s1">'html'</span><span class="p">,</span> <span class="s1">'json'</span><span class="p">]);</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">accepts</span><span class="p">(</span><span class="s1">'html, json'</span><span class="p">);</span>
<span class="c1">// =&gt; "json"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.accepted">req.accepted</h3>

    <p>Return an array of Accepted media types ordered from highest quality to lowest.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span> <span class="p">{</span> <span class="na">value</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">,</span>
    <span class="na">quality</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'application'</span><span class="p">,</span>
    <span class="na">subtype</span><span class="p">:</span> <span class="s1">'json'</span> <span class="p">},</span>
   <span class="p">{</span> <span class="na">value</span><span class="p">:</span> <span class="s1">'text/html'</span><span class="p">,</span>
     <span class="na">quality</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
     <span class="na">type</span><span class="p">:</span> <span class="s1">'text'</span><span class="p">,</span>
     <span class="na">subtype</span><span class="p">:</span> <span class="s1">'html'</span> <span class="p">}</span> <span class="p">]</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.is">req.is(type)</h3>

    <p>Check if the incoming request contains the “Content-Type” 
header field, and it matches the give mime <code class="highlighter-rouge">type</code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// With Content-Type: text/html; charset=utf-8</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s1">'html'</span><span class="p">);</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s1">'text/html'</span><span class="p">);</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s1">'text/*'</span><span class="p">);</span>
<span class="c1">// =&gt; true</span>

<span class="c1">// When Content-Type is application/json</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s1">'json'</span><span class="p">);</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s1">'application/json'</span><span class="p">);</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s1">'application/*'</span><span class="p">);</span>
<span class="c1">// =&gt; true</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s1">'html'</span><span class="p">);</span>
<span class="c1">// =&gt; false</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.ip">req.ip</h3>

    <p>Return the remote address, or when “trust proxy”
is enabled - the upstream address.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">req</span><span class="p">.</span><span class="nx">ip</span>
<span class="c1">// =&gt; "127.0.0.1"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.ips">req.ips</h3>

    <p>When “trust proxy” is <code class="highlighter-rouge">true</code>, parse
the “X-Forwarded-For” ip address list
and return an array, otherwise an empty
array is returned.</p>

    <p>For example if the value were “client, proxy1, proxy2”
you would receive the array <code class="highlighter-rouge">["client", "proxy1", "proxy2"]</code>
where “proxy2” is the furthest down-stream.</p>

  </section>

  <section>
    <h3 id="req.path">req.path</h3>

    <p>Returns the request URL pathname.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// example.com/users?sort=desc</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">path</span>
<span class="c1">// =&gt; "/users"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.host">req.host</h3>

    <p>Returns the hostname from the “Host” header field (void of portno).</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Host: "example.com:3000"</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">host</span>
<span class="c1">// =&gt; "example.com"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.fresh">req.fresh</h3>

    <p>Check if the request is fresh - aka Last-Modified and/or the ETag still match,
indicating that the resource is “fresh”.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">req</span><span class="p">.</span><span class="nx">fresh</span>
<span class="c1">// =&gt; true</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.stale">req.stale</h3>

    <p>Check if the request is stale - aka Last-Modified and/or the ETag do not match,
indicating that the resource is “stale”.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">req</span><span class="p">.</span><span class="nx">stale</span>
<span class="c1">// =&gt; true</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.xhr">req.xhr</h3>

    <p>Check if the request was issued with the “X-Requested-With”
header field set to “XMLHttpRequest” (jQuery etc).</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">req</span><span class="p">.</span><span class="nx">xhr</span>
<span class="c1">// =&gt; true</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.protocol">req.protocol</h3>

    <p>Return the protocol string “http” or “https”
when requested with TLS. When the “trust proxy” 
setting is enabled the “X-Forwarded-Proto” header
field will be trusted. If you’re running behind
a reverse proxy that supplies https for you this
may be enabled.</p>

    <p>js
req.protocol
// =&gt; “http”
~~~</p>

  </section>

  <section>
    <h3 id="req.secure">req.secure</h3>

    <p>Check if a TLS connection is established. This is a short-hand for:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="s1">'https'</span> <span class="o">==</span> <span class="nx">req</span><span class="p">.</span><span class="nx">protocol</span><span class="p">;</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.subdomains">req.subdomains</h3>

    <p>Return subdomains as an array.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Host: "tobi.ferrets.example.com"</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">subdomains</span>
<span class="c1">// =&gt; ["ferrets", "tobi"]</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.originalUrl">req.originalUrl</h3>

    <p>This property is much like <code class="highlighter-rouge">req.url</code>, however it retains
the original request url, allowing you to rewrite <code class="highlighter-rouge">req.url</code>
freely for internal routing purposes. For example the “mounting” feature
of <a href="#app.use">app.use()</a> will rewrite <code class="highlighter-rouge">req.url</code> to
strip the mount point.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// GET /search?q=something</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">originalUrl</span>
<span class="c1">// =&gt; "/search?q=something"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.acceptedLanguages">req.acceptedLanguages</h3>

    <p>Return an array of Accepted languages ordered from highest quality to lowest.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">Accept</span><span class="o">-</span><span class="nx">Language</span><span class="err">:</span> <span class="nx">en</span><span class="p">;</span><span class="nx">q</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="nx">en</span><span class="o">-</span><span class="nx">us</span>
<span class="c1">// =&gt; ['en-us', 'en']</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.acceptedCharsets">req.acceptedCharsets</h3>

    <p>Return an array of Accepted charsets ordered from highest quality to lowest.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">Accept</span><span class="o">-</span><span class="nx">Charset</span><span class="err">:</span> <span class="nx">iso</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">5</span><span class="p">;</span><span class="nx">q</span><span class="o">=</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="nx">unicode</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nx">q</span><span class="o">=</span><span class="mf">0.8</span>
<span class="c1">// =&gt; ['unicode-1-1', 'iso-8859-5']</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="req.acceptsCharset">req.acceptsCharset(charset)</h3>

    <p>Check if the given <code class="highlighter-rouge">charset</code> are acceptable.</p>

  </section>

  <section>
    <h3 id="req.acceptsLanguage">req.acceptsLanguage(lang)</h3>

    <p>Check if the given <code class="highlighter-rouge">lang</code> are acceptable.</p>

  </section>

  <p><a id="response" class="h2"></a></p>
  <h2>Response</h2>

  <section>
    <h3 id="res.status">res.status(code)</h3>

    <p>Chainable alias of node’s <code class="highlighter-rouge">res.statusCode=</code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">404</span><span class="p">).</span><span class="nx">sendfile</span><span class="p">(</span><span class="s1">'path/to/404.png'</span><span class="p">);</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.set">res.set(field, [value])</h3>

    <p>Set header <code class="highlighter-rouge">field</code> to <code class="highlighter-rouge">value</code>, or pass an object to set multiple fields at once.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">,</span> <span class="s1">'text/plain'</span><span class="p">);</span>

<span class="nx">res</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span>
  <span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'text/plain'</span><span class="p">,</span>
  <span class="s1">'Content-Length'</span><span class="p">:</span> <span class="s1">'123'</span><span class="p">,</span>
  <span class="s1">'ETag'</span><span class="p">:</span> <span class="s1">'12345'</span>
<span class="p">})</span>
</code></pre>
    </div>

    <p>Aliased as <code class="highlighter-rouge">res.header(field, [value])</code>.</p>

  </section>

  <section>
    <h3 id="res.get">res.get(field)</h3>

    <p>Get the case-insensitive response header <code class="highlighter-rouge">field</code>.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">);</span>
<span class="c1">// =&gt; "text/plain"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.cookie">res.cookie(name, value, [options])</h3>

    <p>Set cookie <code class="highlighter-rouge">name</code> to <code class="highlighter-rouge">value</code>, which may be a string or object converted to JSON. The <code class="highlighter-rouge">path</code>
option defaults to “/”.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'tobi'</span><span class="p">,</span> <span class="p">{</span> <span class="na">domain</span><span class="p">:</span> <span class="s1">'.example.com'</span><span class="p">,</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'/admin'</span><span class="p">,</span> <span class="na">secure</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">'rememberme'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="p">{</span> <span class="na">expires</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">900000</span><span class="p">),</span> <span class="na">httpOnly</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
</code></pre>
    </div>

    <p>The <code class="highlighter-rouge">maxAge</code> option is a convenience option for setting “expires”
relative to the current time in milliseconds. The following is equivalent to
the previous example.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">'rememberme'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="p">{</span> <span class="na">maxAge</span><span class="p">:</span> <span class="mi">900000</span><span class="p">,</span> <span class="na">httpOnly</span><span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>
</code></pre>
    </div>

    <p>An object may be passed which is then serialized as JSON, which is
automatically parsed by the <code class="highlighter-rouge">bodyParser()</code> middleware.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">'cart'</span><span class="p">,</span> <span class="p">{</span> <span class="na">items</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="p">});</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">'cart'</span><span class="p">,</span> <span class="p">{</span> <span class="na">items</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="p">},</span> <span class="p">{</span> <span class="na">maxAge</span><span class="p">:</span> <span class="mi">900000</span> <span class="p">});</span>
</code></pre>
    </div>

    <p>Signed cookies are also supported through this method. Simply
pass the <code class="highlighter-rouge">signed</code> option. When given <code class="highlighter-rouge">res.cookie()</code>
will use the secret passed to <code class="highlighter-rouge">express.cookieParser(secret)</code>
to sign the value.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'tobi'</span><span class="p">,</span> <span class="p">{</span> <span class="na">signed</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
</code></pre>
    </div>

    <p>Later you may access this value through the <a href="#req.signedCookies">req.signedCookie</a>
object.</p>

  </section>

  <section>
    <h3 id="res.clearCookie">res.clearCookie(name, [options])</h3>

    <p>Clear cookie <code class="highlighter-rouge">name</code>. The <code class="highlighter-rouge">path</code> option defaults to “/”.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'tobi'</span><span class="p">,</span> <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'/admin'</span> <span class="p">});</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">clearCookie</span><span class="p">(</span><span class="s1">'name'</span><span class="p">,</span> <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'/admin'</span> <span class="p">});</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.redirect">res.redirect([status], url)</h3>

    <p>Redirect to the given <code class="highlighter-rouge">url</code> with optional <code class="highlighter-rouge">status</code> code
defaulting to 302 “Found”.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'/foo/bar'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'http://example.com'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="mi">301</span><span class="p">,</span> <span class="s1">'http://example.com'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'../login'</span><span class="p">);</span>
</code></pre>
    </div>

    <p>Express supports a few forms of redirection, first being
a fully qualified URI for redirecting to a different site:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'http://google.com'</span><span class="p">);</span>
</code></pre>
    </div>

    <p>The second form is the pathname-relative redirect, for example
if you were on <code class="highlighter-rouge">http://example.com/admin/post/new</code>, the 
following redirect to <code class="highlighter-rouge">/admin</code> would land you at <code class="highlighter-rouge">http://example.com/admin</code>:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'/admin'</span><span class="p">);</span>
</code></pre>
    </div>

    <p>This next redirect is relative to the <code class="highlighter-rouge">mount</code> point of the application. For example
if you have a blog application mounted at <code class="highlighter-rouge">/blog</code>, ideally it has no knowledge of
where it was mounted, so where a redirect of <code class="highlighter-rouge">/admin/post/new</code> would simply give you
<code class="highlighter-rouge">http://example.com/admin/post/new</code>, the following mount-relative redirect would give
you <code class="highlighter-rouge">http://example.com/blog/admin/post/new</code>:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'admin/post/new'</span><span class="p">);</span>
</code></pre>
    </div>

    <p>Pathname relative redirects are also possible. If you were
on <code class="highlighter-rouge">http://example.com/admin/post/new</code>, the following redirect
would land you at <code class="highlighter-rouge">http//example.com/admin/post</code>:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'..'</span><span class="p">);</span>
</code></pre>
    </div>

    <p>The final special-case is a <code class="highlighter-rouge">back</code> redirect, redirecting back to
the Referer (or Referrer), defaulting to <code class="highlighter-rouge">/</code> when missing.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'back'</span><span class="p">);</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.location">res.location</h3>

    <p>Set the location header.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">location</span><span class="p">(</span><span class="s1">'/foo/bar'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">location</span><span class="p">(</span><span class="s1">'foo/bar'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">location</span><span class="p">(</span><span class="s1">'http://example.com'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">location</span><span class="p">(</span><span class="s1">'../login'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">location</span><span class="p">(</span><span class="s1">'back'</span><span class="p">);</span>
</code></pre>
    </div>

    <p>You can use the same kind of <code class="highlighter-rouge">urls</code> as in <code class="highlighter-rouge">res.redirect()</code>.</p>

    <p>For example, if your application is mounted at <code class="highlighter-rouge">/blog</code>,
the following would set the <code class="highlighter-rouge">location</code> header to
<code class="highlighter-rouge">/blog/admin</code>:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">location</span><span class="p">(</span><span class="s1">'admin'</span><span class="p">)</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.charset">res.charset</h3>

    <p>Assign the charset. Defaults to “utf-8”.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">charset</span> <span class="o">=</span> <span class="s1">'value'</span><span class="p">;</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'&lt;p&gt;some html&lt;/p&gt;'</span><span class="p">);</span>
<span class="c1">// =&gt; Content-Type: text/html; charset=value</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.send">res.send([body|status], [body])</h3>

    <p>Send a response.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="k">new</span> <span class="nx">Buffer</span><span class="p">(</span><span class="s1">'whoop'</span><span class="p">));</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span> <span class="na">some</span><span class="p">:</span> <span class="s1">'json'</span> <span class="p">});</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'&lt;p&gt;some html&lt;/p&gt;'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="mi">404</span><span class="p">,</span> <span class="s1">'Sorry, we cannot find that!'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="p">{</span> <span class="na">error</span><span class="p">:</span> <span class="s1">'something blew up'</span> <span class="p">});</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
</code></pre>
    </div>

    <p>This method performs a myriad of
useful tasks for simple non-streaming responses such
as automatically assigning the Content-Length unless
previously defined and providing automatic <em>HEAD</em> and
HTTP cache freshness support.</p>

    <p>When a <code class="highlighter-rouge">Buffer</code> is given
the Content-Type is set to “application/octet-stream”
unless previously defined as shown below:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">,</span> <span class="s1">'text/html'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="k">new</span> <span class="nx">Buffer</span><span class="p">(</span><span class="s1">'&lt;p&gt;some html&lt;/p&gt;'</span><span class="p">));</span>
</code></pre>
    </div>

    <p>When a <code class="highlighter-rouge">String</code> is given the
Content-Type is set defaulted to “text/html”:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'&lt;p&gt;some html&lt;/p&gt;'</span><span class="p">);</span>
</code></pre>
    </div>

    <p>When an <code class="highlighter-rouge">Array</code> or <code class="highlighter-rouge">Object</code> is
given Express will respond with the JSON representation:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span> <span class="na">user</span><span class="p">:</span> <span class="s1">'tobi'</span> <span class="p">})</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</code></pre>
    </div>

    <p>Finally when a <code class="highlighter-rouge">Number</code> is given without
any of the previously mentioned bodies, then a response
body string is assigned for you. For example 200 will
respond will the text “OK”, and 404 “Not Found” and so on.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.json">res.json([status|body], [body])</h3>

    <p>Send a JSON response. This method is identical
to <code class="highlighter-rouge">res.send()</code> when an object or
array is passed, however it may be used for
explicit JSON conversion of non-objects (null, undefined, etc),
though these are technically not valid JSON.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span> <span class="na">user</span><span class="p">:</span> <span class="s1">'tobi'</span> <span class="p">})</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="p">{</span> <span class="na">error</span><span class="p">:</span> <span class="s1">'message'</span> <span class="p">})</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.jsonp">res.jsonp([status|body], [body])</h3>

    <p>Send a JSON response with JSONP support. This method is identical
to <code class="highlighter-rouge">res.json()</code> however opts-in to JSONP callback
support.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">jsonp</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span>
<span class="c1">// =&gt; null</span>

<span class="nx">res</span><span class="p">.</span><span class="nx">jsonp</span><span class="p">({</span> <span class="na">user</span><span class="p">:</span> <span class="s1">'tobi'</span> <span class="p">})</span>
<span class="c1">// =&gt; { "user": "tobi" }</span>

<span class="nx">res</span><span class="p">.</span><span class="nx">jsonp</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="p">{</span> <span class="na">error</span><span class="p">:</span> <span class="s1">'message'</span> <span class="p">})</span>
<span class="c1">// =&gt; { "error": "message" }</span>
</code></pre>
    </div>

    <p>By default the JSONP callback name is simply <code class="highlighter-rouge">callback</code>,
however you may alter this with the <a href="#app-settings">jsonp callback name</a>
setting. The following are some examples of JSONP responses using the same
code:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// ?callback=foo</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">jsonp</span><span class="p">({</span> <span class="na">user</span><span class="p">:</span> <span class="s1">'tobi'</span> <span class="p">})</span>
<span class="c1">// =&gt; foo({ "user": "tobi" })</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'jsonp callback name'</span><span class="p">,</span> <span class="s1">'cb'</span><span class="p">);</span>

<span class="c1">// ?cb=foo</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">jsonp</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="p">{</span> <span class="na">error</span><span class="p">:</span> <span class="s1">'message'</span> <span class="p">})</span>
<span class="c1">// =&gt; foo({ "error": "message" })</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.type">res.type(type)</h3>

    <p>Sets the Content-Type to the mime lookup of <code class="highlighter-rouge">type</code>,
or when “/” is present the Content-Type is simply set to this
literal value.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s1">'.html'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s1">'html'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s1">'json'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s1">'application/json'</span><span class="p">);</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s1">'png'</span><span class="p">);</span>
</code></pre>
    </div>

    <p>p Aliased as <code class="highlighter-rouge">res.contentType(type)</code>.</p>

  </section>

  <section>
    <h3 id="res.format">res.format(object)</h3>

    <p>Performs content-negotiation on the request Accept header
field when present. This method uses <code class="highlighter-rouge">req.accepted</code>, an array of
acceptable types ordered by their quality values, otherwise the
first callback is invoked. When no match is performed the server
responds with 406 “Not Acceptable”, or invokes the <code class="highlighter-rouge">default</code>
callback.</p>

    <p>The Content-Type is set for you when a callback is selected,
however you may alter this within the callback using <code class="highlighter-rouge">res.set()</code>
or <code class="highlighter-rouge">res.type()</code> etcetera.</p>

    <p>The following example would respond with <code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hey"</span><span class="w"> </span><span class="p">}</span></code>
when the Accept header field is set to “application/json” or “<em>/json”,
however if “</em>/*” is given then “hey” will be the response.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">format</span><span class="p">({</span>
  <span class="s1">'text/plain'</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'hey'</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="s1">'text/html'</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'&lt;p&gt;hey&lt;/p&gt;'</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="s1">'application/json'</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span> <span class="na">message</span><span class="p">:</span> <span class="s1">'hey'</span> <span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
    </div>

    <p>In addition to canonicalized MIME types you may also
use extnames mapped to these types, providing a slightly
less verbose implementation:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">format</span><span class="p">({</span>
  <span class="na">text</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'hey'</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="na">html</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'&lt;p&gt;hey&lt;/p&gt;'</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="na">json</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span> <span class="na">message</span><span class="p">:</span> <span class="s1">'hey'</span> <span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.attachment">res.attachment([filename])</h3>

    <p>Sets the Content-Disposition header field to “attachment”. If
a <code class="highlighter-rouge">filename</code> is given then the Content-Type will be
automatically set based on the extname via <code class="highlighter-rouge">res.type()</code>,
and the Content-Disposition’s “filename=” parameter will be set.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">attachment</span><span class="p">();</span>
<span class="c1">// Content-Disposition: attachment</span>

<span class="nx">res</span><span class="p">.</span><span class="nx">attachment</span><span class="p">(</span><span class="s1">'path/to/logo.png'</span><span class="p">);</span>
<span class="c1">// Content-Disposition: attachment; filename="logo.png"</span>
<span class="c1">// Content-Type: image/png</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.sendfile">res.sendfile(path, [options], [fn]])</h3>

    <p>Transfer the file at the given <code class="highlighter-rouge">path</code>.</p>

    <p>Automatically defaults the Content-Type response header field based
on the filename’s extension. The callback <code class="highlighter-rouge">fn(err)</code> is 
invoked when the transfer is complete or when an error occurs.</p>

    <p>Options:</p>

    <ul>
      <li><code class="highlighter-rouge">maxAge</code> in milliseconds defaulting to 0</li>
      <li><code class="highlighter-rouge">root</code> root directory for relative filenames</li>
    </ul>

    <p>This method provides fine-grained support for file serving
as illustrated in the following example:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/user/:uid/photos/:file'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">uid</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">uid</span>
    <span class="p">,</span> <span class="nx">file</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">file</span><span class="p">;</span>

  <span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">mayViewFilesFrom</span><span class="p">(</span><span class="nx">uid</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">yes</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">yes</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">sendfile</span><span class="p">(</span><span class="s1">'/uploads/'</span> <span class="o">+</span> <span class="nx">uid</span> <span class="o">+</span> <span class="s1">'/'</span> <span class="o">+</span> <span class="nx">file</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="mi">403</span><span class="p">,</span> <span class="s1">'Sorry! you cant see that.'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.download">res.download(path, [filename], [fn])</h3>

    <p>Transfer the file at <code class="highlighter-rouge">path</code> as an “attachment”,
typically browsers will prompt the user for download. The
Content-Disposition “filename=” parameter, aka the one
that will appear in the brower dialog is set to <code class="highlighter-rouge">path</code>
by default, however you may provide an override <code class="highlighter-rouge">filename</code>.</p>

    <p>When an error has ocurred or transfer is complete the optional 
callback <code class="highlighter-rouge">fn</code> is invoked. This method uses <a href="#res.sendfile">res.sendfile()</a>
to transfer the file.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">download</span><span class="p">(</span><span class="s1">'/report-12345.pdf'</span><span class="p">);</span>

<span class="nx">res</span><span class="p">.</span><span class="nx">download</span><span class="p">(</span><span class="s1">'/report-12345.pdf'</span><span class="p">,</span> <span class="s1">'report.pdf'</span><span class="p">);</span>

<span class="nx">res</span><span class="p">.</span><span class="nx">download</span><span class="p">(</span><span class="s1">'/report-12345.pdf'</span><span class="p">,</span> <span class="s1">'report.pdf'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// handle error, keep in mind the response may be partially-sent</span>
    <span class="c1">// so check res.headerSent</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// decrement a download credit etc</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.links">res.links(links)</h3>

    <p>Join the given <code class="highlighter-rouge">links</code> to populate the “Link” response header field.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">links</span><span class="p">({</span>
  <span class="na">next</span><span class="p">:</span> <span class="s1">'http://api.example.com/users?page=2'</span><span class="p">,</span>
  <span class="na">last</span><span class="p">:</span> <span class="s1">'http://api.example.com/users?page=5'</span>
<span class="p">});</span>
</code></pre>
    </div>

    <p>p yields:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">Link</span><span class="err">:</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nl">http</span><span class="p">:</span><span class="c1">//api.example.com/users?page=2&amp;gt;; rel="next", </span>
      <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nl">http</span><span class="p">:</span><span class="c1">//api.example.com/users?page=5&amp;gt;; rel="last"</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.locals">res.locals</h3>

    <p>Response local variables are scoped to the request, thus only
available to the view(s) rendered during that request / response
cycle, if any. Otherwise this API is identical to <a href="#app.locals">app.locals</a>.</p>

    <p>This object is useful for exposing request-level information such as the
request pathname, authenticated user, user settings etcetera.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">){</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">;</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">authenticated</span> <span class="o">=</span> <span class="o">!</span> <span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">anonymous</span><span class="p">;</span>
  <span class="nx">next</span><span class="p">();</span>
<span class="p">});</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="res.render">res.render(view, [locals], callback)</h3>

    <p>Render a <code class="highlighter-rouge">view</code> with a callback responding with
the rendered string. When an error occurs <code class="highlighter-rouge">next(err)</code>
is invoked internally. When a callback is provided both the possible error
and rendered string are passed, and no automated response is performed.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'index'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">html</span><span class="p">){</span>
  <span class="c1">// ...</span>
<span class="p">});</span>

<span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'Tobi'</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">html</span><span class="p">){</span>
  <span class="c1">// ...</span>
<span class="p">});</span>
</code></pre>
    </div>

  </section>

  <p><a id="middleware" class="h2"></a></p>
  <h2>Middleware</h2>

  <section>
    <h3 id="basicAuth">basicAuth()</h3>

    <p>Basic Authentication middleware, populating <code class="highlighter-rouge">req.user</code>
with the username.</p>

    <p>Simple username and password:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">basicAuth</span><span class="p">(</span><span class="s1">'username'</span><span class="p">,</span> <span class="s1">'password'</span><span class="p">));</span>
</code></pre>
    </div>

    <p>Callback verification:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">basicAuth</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="nx">pass</span><span class="p">){</span>
   <span class="k">return</span> <span class="s1">'tj'</span> <span class="o">==</span> <span class="nx">user</span> <span class="o">&amp;&amp;</span> <span class="s1">'wahoo'</span> <span class="o">==</span> <span class="nx">pass</span><span class="p">;</span>
 <span class="p">}));</span>
</code></pre>
    </div>

    <p>Async callback verification, accepting <code class="highlighter-rouge">fn(err, user)</code>,
in this case <code class="highlighter-rouge">req.user</code> will be the user object passed.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">basicAuth</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="nx">pass</span><span class="p">,</span> <span class="nx">fn</span><span class="p">){</span>
  <span class="nx">User</span><span class="p">.</span><span class="nx">authenticate</span><span class="p">({</span> <span class="na">user</span><span class="p">:</span> <span class="nx">user</span><span class="p">,</span> <span class="na">pass</span><span class="p">:</span> <span class="nx">pass</span> <span class="p">},</span> <span class="nx">fn</span><span class="p">);</span>
<span class="p">}))</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="bodyParser">bodyParser()</h3>

    <p>Request body parsing middleware supporting JSON, urlencoded,
and multipart requests. This middleware is simply a wrapper
for the <code class="highlighter-rouge">json()</code>, <code class="highlighter-rouge">urlencoded()</code>, and
<code class="highlighter-rouge">multipart()</code> middleware.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">bodyParser</span><span class="p">());</span>

<span class="c1">// is equivalent to:</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">multipart</span><span class="p">());</span>
</code></pre>
    </div>

    <p>For security sake, it’s better to disable file upload if your application
doesn’t need it. To do this, use only the needed middleware, i.e. don’t use
the <code class="highlighter-rouge">bodyParser</code> and <code class="highlighter-rouge">multipart()</code> middleware:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">());</span>
</code></pre>
    </div>

    <p>If your application needs file upload you should set up
<a href="https://groups.google.com/d/msg/express-js/iP2VyhkypHo/5AXQiYN3RPcJ">a strategy for dealing with those files</a>.</p>

  </section>

  <section>
    <h3 id="compress">compress()</h3>

    <p>Compress response data with gzip / deflate. This middleware
should be placed “high” within the stack to ensure all
responses may be compressed.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">logger</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">compress</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">methodOverride</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">bodyParser</span><span class="p">());</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="cookieParser">cookieParser()</h3>

    <p>Parses the Cookie header field and populates <code class="highlighter-rouge">req.cookies</code>
with an object keyed by the cookie names. Optionally you may enabled 
signed cookie support by passing a <code class="highlighter-rouge">secret</code> string.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">cookieParser</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">cookieParser</span><span class="p">(</span><span class="s1">'some secret'</span><span class="p">));</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="cookieSession">cookieSession()</h3>

    <p>Provides cookie-based sessions, and populates <code class="highlighter-rouge">req.session</code>.
This middleware takes the following options:</p>

    <ul>
      <li><code class="highlighter-rouge">key</code> cookie name defaulting to <code class="highlighter-rouge">connect.sess</code></li>
      <li><code class="highlighter-rouge">secret</code> prevents cookie tampering</li>
      <li><code class="highlighter-rouge">cookie</code> session cookie settings, defaulting to <code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="err">path:</span><span class="w"> </span><span class="err">'/',</span><span class="w"> </span><span class="err">httpOnly:</span><span class="w"> </span><span class="err">true,</span><span class="w"> </span><span class="err">maxAge:</span><span class="w"> </span><span class="err">null</span><span class="w"> </span><span class="p">}</span></code></li>
      <li><code class="highlighter-rouge">proxy</code> trust the reverse proxy when setting secure cookies (via “x-forwarded-proto”)</li>
    </ul>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">cookieSession</span><span class="p">());</span>
</code></pre>
    </div>

    <p>To clear a cookie simply assign the session to null before responding:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">req</span><span class="p">.</span><span class="nx">session</span> <span class="o">=</span> <span class="kc">null</span>
</code></pre>
    </div>

  </section>

  <section>
    <h3 id="csrf">csrf()</h3>

    <p>CSRF protection middleware.</p>

    <p>By default this middleware generates a token named “_csrf”
which should be added to requests which mutate
state, within a hidden form field, query-string etc. This
token is validated against <code class="highlighter-rouge">req.csrfToken()</code>.</p>

    <p>The default <code class="highlighter-rouge">value</code> function checks <code class="highlighter-rouge">req.body</code> generated
by the <code class="highlighter-rouge">bodyParser()</code> middleware, <code class="highlighter-rouge">req.query</code> generated
by <code class="highlighter-rouge">query()</code>, and the “X-CSRF-Token” header field.</p>

    <p>This middleware requires session support, thus should be added
somewhere below <code class="highlighter-rouge">session()</code>.</p>

  </section>

  <section>
    <h3 id="directory">directory()</h3>

    <p>Directory serving middleware, serves the given <code class="highlighter-rouge">path</code>.
This middleware may be paired with <code class="highlighter-rouge">static()</code> to serve
files, providing a full-featured file browser.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">directory</span><span class="p">(</span><span class="s1">'public'</span><span class="p">))</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="s1">'public'</span><span class="p">))</span>
</code></pre>
    </div>

    <p>This middleware accepts the following options:</p>

    <ul>
      <li><code class="highlighter-rouge">hidden</code> display hidden (dot) files. Defaults to false.</li>
      <li><code class="highlighter-rouge">icons</code>  display icons. Defaults to false.</li>
      <li><code class="highlighter-rouge">filter</code> Apply this filter function to files. Defaults to false.</li>
    </ul>

  </section>

</div>


    </section>

    <noscript>
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5XL76H" height="0" width="0" style="display: none; visibility: hidden;"></iframe>
</noscript>
<script>
(function(w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({
        'gtm.start': new Date().getTime(),
        event: 'gtm.js'
    });
    var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != 'dataLayer' ? '&l=' + l : '';
    j.async = true;
    j.src =
        '//www.googletagmanager.com/gtm.js?id=' + i + dl;
    f.parentNode.insertBefore(j, f);
})(window, document, 'script', 'dataLayer', 'GTM-5XL76H');
</script>
<a id="top" href="#"><img src="/images/arrow.png"></a>

<footer>
    <div id="footer-content">
        <div id="github">
            <iframe src="http://ghbtns.com/github-btn.html?user=strongloop&amp;repo=express&amp;type=watch&amp;count=true" allowtransparency="true" frameborder="0" scrolling="0" width="110" height="20"></iframe>
        </div>
        <div id="sponsor">The <a href="https://github.com/strongloop/express/">Express project</a> is sponsored by <a href="http://strongloop.com/">StrongLoop</a>. </div>
        <div id="fork"><a href="https://github.com/strongloop/expressjs.com">Fork the website on GitHub</a>.
        </div>
        <div>Copyright &copy; StrongLoop, Inc., and other expressjs.com contributors.</div>
    </div>
</footer>


  </body>

</html>
